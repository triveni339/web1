<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Weather App with Chatbot</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      min-height: 100vh;
      background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=80') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      padding: 20px;
    }

    .search-container {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .search-container input {
      padding: 10px;
      border: none;
      border-radius: 5px;
      width: 200px;
    }

    .search-container button {
      padding: 10px 20px;
      background-color: #3498DB;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .weather-card {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 20px;
      max-width: 300px;
      text-align: center;
    }

    .location {
      font-size: 1.5rem;
      font-weight: bold;
      color: #2C3E50;
      margin-bottom: 10px;
    }

    .weather-emoji {
      font-size: 2.5rem;
      margin: 10px 0;
    }

    .temperature {
      font-size: 2.5rem;
      font-weight: bold;
      color: #2C3E50;
      margin-bottom: 5px;
    }

    .description {
      font-size: 1rem;
      color: #7F8C8D;
      text-transform: capitalize;
      margin-bottom: 15px;
    }

    .details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 15px;
    }

    .detail-item {
      background: #ECF0F1;
      padding: 10px;
      border-radius: 8px;
      text-align: left;
    }

    .detail-item span {
      font-weight: bold;
      color: #2C3E50;
      display: block;
      margin-bottom: 5px;
    }

    .detail-item div {
      color: #7F8C8D;
    }

    
    .chat-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 50;
      background: grey;
      border: grey;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .chat-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .chat-icon:hover {
      transform: scale(1.1);
    }

    .chat-window {
      position: fixed;
      bottom: 80px;
      right: 20px;
      width: 300px;
      height: 300px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      display: none;
      flex-direction: column;
      z-index: 100;
      overflow: hidden;
    }

    .chat-header {
      background: #3498DB;
      color: white;
      padding: 10px;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: bold;
    }

    .chat-messages {
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
      max-height: calc(80vh - 110px);
      scrollbar-width: thin;
    }

    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }

    .chat-messages::-webkit-scrollbar-thumb {
      background: #3498DB;
      border-radius: 3px;
    }

    .chat-input-container {
      padding: 10px;
      border-top: 1px solid #ddd;
    }

    .message {
      margin: 5px 0;
      padding: 8px 12px;
      border-radius: 10px;
      max-width: 70%;
    }

    .user-message {
      background: #3498DB;
      color: white;
      margin-left: auto;
    }

    .bot-message {
      background: #ECF0F1;
      color: #2C3E50;
    }

    .typing-indicator {
      background: #ECF0F1;
      color: #7F8C8D;
      margin: 5px 0;
      padding: 8px 12px;
      border-radius: 10px;
      max-width: 70%;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
    }

    @media (max-width: 600px) {
      .weather-emoji {
        font-size: 2rem;
      }

      .weather-card {
        max-width: 90%;
      }

      .chat-toggle {
        bottom: 15px;
        right: 15px;
        width: 40px;
        height: 40px;
      }

      .chat-icon {
        width: 35px;
        height: 35px;
      }

      .chat-window {
        width: 90%;
        bottom: 60px;
        right: 5%;
      }
    }
  </style>
</head>
<body>

  <div class="search-container">
    <input type="text" id="city-input" placeholder="Enter city name">
    <button id="search-btn">Search</button>
  </div>

  <div class="weather-card">
    <h1 id="location" class="location">Enter a city to get weather</h1>
    <div class="weather-emoji" id="weather-emoji">‚è≥</div>
    <div class="temperature" id="temperature">--¬∞C</div>
    <div class="description" id="description">--</div>
    <div class="details">
      <div class="detail-item"><span>Humidity</span><div id="humidity">--%</div></div>
      <div class="detail-item"><span>Wind</span><div id="wind-speed">-- m/s</div></div>
      <div class="detail-item"><span>Feels like</span><div id="feels-like">--¬∞C</div></div>
      <div class="detail-item"><span>Pressure</span><div id="pressure">-- hPa</div></div>
    </div>
    <div class="error text-red-600 text-sm mt-3 hidden" id="error-message"></div>
  </div>

  
  <button id="chat-toggle" class="chat-toggle">
    <img src="C:\Users\Vasantha\Downloads\Graident Ai Robot.jpg" alt="Chatbot" class="chat-icon">
  </button>

  <div id="chat-window" class="chat-window">
    <div class="chat-header">
      <span>Weather Assistant</span>
      <button id="chat-close" class="text-xl">√ó</button>
    </div>
    <div class="chat-messages"><div id="chat-messages"></div></div>
    <div class="chat-input-container">
      <input id="chat-input" type="text" placeholder="Ask me anything..." class="w-full p-2 border rounded">
      <button id="chat-send" class="mt-2 w-full bg-green-500 text-white p-2 rounded hover:bg-green-600">Send</button>
    </div>
  </div>

  <script>
    const API_KEY = '9b6d27ef6059bc7536c10a8f90b9169a';
    const GEMINI_API_KEY = 'AIzaSyCnGQS2RmFVcBOcFb5hAPPYJ5MpoCctq9U';

    const weatherEmoji = {
      'Clear': '‚òÄÔ∏è', 'Clouds': '‚òÅÔ∏è', 'Rain': 'üåßÔ∏è', 'Drizzle': 'üå¶Ô∏è',
      'Thunderstorm': '‚õàÔ∏è', 'Snow': '‚ùÑÔ∏è', 'Mist': 'üå´Ô∏è', 'Fog': 'üå´Ô∏è'
    };

    function showError(message) {
      const errorEl = document.getElementById('error-message');
      errorEl.textContent = message;
      errorEl.classList.remove('hidden');
    }

    function updateWeather(data) {
      const weatherMain = data.weather[0].main;
      document.getElementById('location').textContent = data.name;
      document.getElementById('temperature').textContent = `${Math.round(data.main.temp)}¬∞C`;
      document.getElementById('description').textContent = data.weather[0].description;
      document.getElementById('humidity').textContent = `${data.main.humidity}%`;
      document.getElementById('wind-speed').textContent = `${data.wind.speed} m/s`;
      document.getElementById('feels-like').textContent = `${Math.round(data.main.feels_like)}¬∞C`;
      document.getElementById('pressure').textContent = `${data.main.pressure} hPa`;
      document.getElementById('weather-emoji').textContent = weatherEmoji[weatherMain] || 'üåç';
    }

    function searchCityWeather() {
      const city = document.getElementById('city-input').value.trim();
      if (!city) {
        showError('Please enter a city name');
        return;
      }
      fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${API_KEY}`)
        .then(response => response.json())
        .then(data => {
          if (data.cod === 200) {
            updateWeather(data);
          } else {
            showError('City not found');
          }
        })
        .catch(() => showError('Network error. Please try again later.'));
    }

    document.getElementById('search-btn').addEventListener('click', searchCityWeather);
    document.getElementById('city-input').addEventListener('keypress', e => {
      if (e.key === 'Enter') searchCityWeather();
    });

    
    const chatWindow = document.getElementById('chat-window');
    const chatToggle = document.getElementById('chat-toggle');
    const chatClose = document.getElementById('chat-close');
    const chatSend = document.getElementById('chat-send');
    const chatInput = document.getElementById('chat-input');
    const chatMessages = document.getElementById('chat-messages');

    function toggleChat() {
      chatWindow.style.display = chatWindow.style.display === 'none' ? 'flex' : 'none';
    }

    function addMessage(content, isUser = false, isTyping = false) {
      const messageDiv = document.createElement('div');
      messageDiv.className = isTyping ? 'typing-indicator' : `message ${isUser ? 'user-message' : 'bot-message'}`;
      messageDiv.textContent = isTyping ? 'Typing...' : content;
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      return messageDiv;
    }

    async function sendDummyResponse(userMessage) {
      const temp = document.getElementById('temperature').textContent;
      const typingIndicator = addMessage('', false, true);

      const payload = {
        contents: [ { parts: [ { text: `Based on current temperature ${temp}, ${userMessage}` } ] } ]
      };

      try {
        const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-goog-api-key': GEMINI_API_KEY
          },
          body: JSON.stringify(payload)
        });

        const data = await response.json();
        const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || 'Sorry, I couldn\'t process that.';
        typingIndicator.remove();
        addMessage(aiResponse);
      } catch {
        typingIndicator.remove();
        addMessage('Error fetching AI response.');
      }
    }

    chatToggle.addEventListener('click', toggleChat);
    chatClose.addEventListener('click', toggleChat);
    chatSend.addEventListener('click', () => {
      const message = chatInput.value.trim();
      if (message) {
        addMessage(message, true);
        chatInput.value = '';
        sendDummyResponse(message);
      }
    });

    chatInput.addEventListener('keypress', e => {
      if (e.key === 'Enter' && chatInput.value.trim()) {
        const message = chatInput.value.trim();
        addMessage(message, true);
        chatInput.value = '';
        sendDummyResponse(message);
      }
    });
  </script>
</body>
</html>

